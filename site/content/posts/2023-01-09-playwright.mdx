---
featured: true
title: ç”¨å¾®è»Ÿ playwright è¼•æ˜“æ­å»º End to End Testing è‡ªå‹•åŒ–æ¸¬è©¦ç’°å¢ƒï¼Œä¿è­·å…¬å¸çš„æ ¸å¿ƒå•†æ¥­ç¶²ç«™ï¼Œä¸¦æ•´åˆ Teams é€šçŸ¥åŠå¤–éƒ¨è§¸ç™¼
date:  2023-01-09 01:01:01 +0800
thumbnail: playwright.png
category: Frontend
tags: ['playwright','Vscode','Github action','end to end test']
description : ç”¨å¾®è»Ÿ playwright åŠ Github action å¯¦è¸ End to End è¼•æ˜“æ­å»ºè‡ªå‹•åŒ–æ¸¬è©¦æ¡†æ¶ï¼Œä¿è­·å…¬å¸çš„æ ¸å¿ƒå•†æ¥­ç¶²ç«™ã€‚
author : Mark Ku
slug: playwright-end-to-end-test
---
## è§£æ±ºå•é¡Œ
æˆ‘ç›®å‰ä»»è·æµé‡ä¸å°çš„ B2C é›»å­å•†å‹™å…¬å¸ï¼Œç‚ºé¿å…ä¸å°å¿ƒå°‡çµå¸³ç•«é¢æ”¹å£äº†ï¼Œè€Œæ²’è¢«ç™¼ç¾ï¼Œè€Œæˆ‘è‘—æ‰‹ç ”ç©¶ UI TESTï¼Œç”¨æ–¼ä¿è­·æˆ‘å€‘çš„çµå¸³æµç¨‹ï¼Œä¹‹å‰å°±æœ‰ç”¨ playwright ä¾†åš SEO çš„é æ¸²æŸ“ï¼Œåœ¨è©•ä¼°äº†å¹¾å¥— UI æ¸¬è©¦å¾Œï¼Œç™¼ç¾ playwright é€™å¹¾å¹´ç”Ÿæ…‹è®Šå¾—å¾ˆå®Œæ•´åŠç°¡å–®ï¼Œéå¸¸é©åˆæˆ‘å€‘ï¼Œå…¶å„ªé»å¦‚ä¸‹ 
* å¾®è»Ÿæ¨å‡ºçš„é–‹æº UI-Test æ¡†æ¶
* æ•´åˆ Jest 
* æ”¯æ´ vs code é–‹ç™¼åŠé™¤éŒ¯
* é è¨­æ•´åˆ Github
* æä¾›å®Œæ•´çš„ Report
* ä¸ç”¨åƒ Python è¦è¨­å®šå¾ˆå¤šç’°å¢ƒ
* æ”¯æ´ node js
## æˆ‘é æœŸçš„é‹ä½œæµç¨‹
![](https://i.imgur.com/NR4HTbm.png)
## æ­¥é©Ÿ
### é¦–å…ˆï¼Œæˆ‘å€‘å…ˆå»ºç«‹ playwright æ¸¬è©¦å°ˆæ¡ˆ [å®˜æ–¹æ–‡ä»¶](https://playwright.dev/docs/release-notes)
```
npm init playwright@latest

```
### é¸æ“‡ Typescript åŠ github action flow æ•´åˆ
![](https://i.imgur.com/yo5sRXA.png)
### æ‰“é–‹å‰›å‰›å»ºç«‹çš„æ¸¬è©¦å°ˆæ¡ˆï¼Œåœ¨è³‡æ–™å¤¾è£¡å…¶å¯¦å·±å¯«å¥½åŸºæœ¬çš„æ¸¬è©¦ç¯„ä¾‹
![](https://i.imgur.com/SmwdCUI.png)
### è«‹å…ˆåœ¨ vscode å®‰è£ [jest å¥—ä»¶](https://marketplace.visualstudio.com/items?itemName=Orta.vscode-jest)
### ä¸¦åŠ å…¥ä¸­æ–·é»ï¼Œä¸¦å°ç¶ è‰²çš„å•Ÿå‹•ç®­é ­ >å³éµ > å°æ¸¬è©¦åµéŒ¯
![](https://i.imgur.com/J3F3ki4.png)
### æ­¤æ™‚å°±æœƒè·³å‡ºç€è¦½å™¨ï¼Œä¸¦å¯ä»¥é€è¡Œé™¤éŒ¯
![](https://i.imgur.com/npHATRA.png)
### çœ‹åˆ°é€™é‚Šçˆ½åº¦å°±çˆ½åº¦è¶…é«˜ï¼Œéå»å¯«é python selenium éƒ½é‚„è¦èŠ±å¾ˆå¤šæ™‚é–“é…ç½®ç³»çµ±ç’°å¢ƒã€‚
### æ¥è‘—ï¼Œå°‡ä½ çš„å°ˆæ¡ˆæ¨ä¸Š githubï¼Œæ­¤æ™‚å°±æœƒè‡ªå‹•å»ºç½®( æ¸¬è©¦ )ï¼Œé»é–‹å·¥ä½œè¨˜éŒ„
![](https://i.imgur.com/q5VA5SS.png)
### éš¨å¾Œæˆ‘å€‘å¯ä»¥ç™¼ç¾æ¸¬è©¦å·±æˆåŠŸå®Œæˆå»ºç½®ï¼Œä¸¦ç™¼ç¾ä¸»æ§å°å…¥å£åŠå ±è¡¨çš„å…¥å£
![](https://i.imgur.com/AkLBTY1.png)
### é»æ“Šé€²å…¥æ¸¬è©¦ä¸»æ§å°ï¼Œå¯ä»¥çœ‹ job åŸ·è¡Œäº†äº›ä»€éº¼
![](https://i.imgur.com/5Ix7h3U.png)
### æ‰“é–‹ä¸‹è¼‰çš„å ±è¡¨
![](https://i.imgur.com/HS9dxhw.png)
### æ¥è‘—ï¼Œå› æˆ‘å€‘é æœŸå°‡æ¸¬è©¦çš„çµæœåŠå ±è¡¨æ¨é€åˆ° Teams 
![](https://i.imgur.com/QKCoX7d.png)
### è«‹å…ˆè‡³ github repo çš„ Settings > Secrets > å»ºç«‹ Actions secrets åƒæ•¸ã€‚
![](https://i.imgur.com/K700jnK.png)
### ä¿®æ”¹ .github/workflows/playwright.yml åƒè€ƒä»¥ä¸‹ç¨‹å¼ç¢¼ï¼ŒåŠ å…¥é€šçŸ¥
```
name: Playwright Tests
on:
  repository_dispatch:
    types: remote-trigger-ui-test
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]
jobs:
  test:
    timeout-minutes: 60
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - uses: actions/setup-node@v3
      with:
        node-version: 16
    - name: Install dependencies
      run: npm ci
    - name: Install Playwright Browsers
      run: npx playwright install --with-deps
    - name: Run Playwright tests
      run: npx playwright test
    - uses: actions/upload-artifact@v3
      if: always()
      with:
        name: playwright-report
        path: playwright-report/
        retention-days: 30
  success_notify:
    needs: test
    name: notify
    runs-on: ubuntu-18.04    
    steps:  
      - name: ğŸ“£ Send teams notification
        uses: simbo/msteams-message-card-action@v1
        with:
          webhook: ${{ secrets.MSTEAMS_WEBHOOK }}
          title: ğŸ˜Š UI - Test Success 
          message: <p>UI - Test Success<strong>\ ^ ^ /</strong></p>
          color: 007FFF
          buttons: |
            See Test Report! ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}      
  error_notify:
    needs: test
    name: error_notify
    if: ${{ always() && needs.test.result == 'failure' }}
    runs-on: ubuntu-18.04    
    steps:        
      - name: Send fail notification
        uses: simbo/msteams-message-card-action@v1        
        with:
          webhook: ${{ secrets.MSTEAMS_WEBHOOK }}
          title: ğŸ’©UI - Test Fail 
          message: <p>Ba Be Q ...<strong>= =...</strong></p>
          color: FF0000
          buttons: |
            See Test Report! ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}
```
### æ¸¬è©¦åŸ·è¡Œå®Œçš„åœ–è¡¨
![](https://i.imgur.com/CDMyIoQ.png)
### åœ¨æ¬²æ‡‰ç”¨ç¨‹å¼ï¼Œæ–°å¢å¤–éƒ¨è§¸ç™¼ wrokflowsï¼Œ[å¯åƒè€ƒæ­¤ç¯‡è¨­å®šé ç¨‹è§¸ç™¼ git action](https://www.chenshaowen.com/blog/how-to-trigger-github-action-remotely.html)ï¼Œä¸¦å°‡ä¸‹é¢çš„ç¨‹å¼ç¢¼åƒæ•¸æ›æ‰
:owner/:repo => markku636/first-ui-teset  
:token => [Github token é»æˆ‘ç”³è«‹](https://github.com/settings/tokens/new)  
```
on: push
jobs:
  test-curl-action:
    name: "Call Test CICD"
    runs-on: ubuntu-latest
    steps:      
      - name: "Call Github API"
        uses: indiesdev/curl@v1.1
        id: api2
        with:
          url: https://api.github.com/repos/:owner/:repo/dispatches
          method: "POST"
          accept: 200,201,204
          headers: '{ "authorization": "token :token", "accept": "application/vnd.github.everest-preview+json","content-type":"application/x-www-form-urlencoded" }'

          # you can use multiline format to construct json data object, the content should be yml format.
           
          # this format apply to inputs: body, headers and params
          "body": '{ "event_type": "remote-trigger-ui-test" }'
          log-response: true
      - name: "Use response"
        run: echo ${{ steps.api.outputs.response }}

```

### éŒ„è£½è…³æœ¬
è¶…é…·çš„ï¼Œä»€éº¼ç’°å¢ƒä¹Ÿæ²’ç‰¹åˆ¥é…ç½®ï¼Œå±…ç„¶èƒ½å¤ è·³å‡ºç€è¦½å™¨éŒ„è£½ï¼ŒçœŸçš„æ˜¯å¤ªå¥½ç”¨äº†  

```
npx playwright codegen www.ibuypower.com --output ./tests/ibuypower.spec.js
```
![](https://i.imgur.com/z8AamkQ.png)

## çµè«–
ä½¿ç”¨ playwright æœ€å¤§çš„å¥½è™•ï¼Œå¾®è»ŸæŒ¾è‘—å®Œæ•´çš„ç”Ÿæ…‹ï¼ŒæŠŠæ•´å€‹å·¥ä½œæµç¨‹éƒ½æ•´åˆèµ·ä¾†ï¼Œæˆ‘åƒ…ç”¨å¾ˆçŸ­çš„æ™‚é–“ï¼Œå°±èƒ½å°‡ vscode + github + teams æ•´åˆå®Œæˆï¼Œçˆ½åº¦è¶…ç´šé«˜ã€‚

## è£œå……
å¦‚æœç„¡æ³•åœ¨ vscode ä¸­ä½¿ç”¨ jest åµéŒ¯æ¸¬è©¦æª”ï¼Œè«‹åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤
```
npm install -D jest jest-playwright-preset playwright
```
## åƒè€ƒè³‡æ–™
* [å¦‚ä½•è¿œç¨‹è§¦å‘ GitHub Action](https://www.chenshaowen.com/blog/how-to-trigger-github-action-remotely.html)
* [MS Teams Message Card](https://github.com/marketplace/actions/ms-teams-message-card)
