---
featured: true
title: å¤šé€šè·¯èŠå¤©æ•´åˆå¯¦æˆ°ï¼šé–‹æºèŠå¤©è»Ÿé«” Rocket.Chat Omnichannel å¹³å°éƒ¨ç½²èˆ‡æ‡‰ç”¨ 
slug: rocket-chat-omnichannel-integration
category: DevOps
thumbnail: rocket-chat.png
date: 2025-07-29 06:01:00 +0800
tags: ['Rocket.Chat', 'Omnichannel', 'Multi-Channel', 'Livechat', 'Customer Service', 'Docker', 'MongoDB', 'DevOps']
description: é€é Rocket.Chat çš„ Omnichannel åŠŸèƒ½ï¼Œæ•´åˆç¶²ç«™èŠå¤©ã€WhatsAppã€Facebook Messengerã€Telegram ç­‰å¤šç¨®é€šè¨Šç®¡é“ï¼Œæ‰“é€ çµ±ä¸€çš„å®¢æˆ¶æœå‹™å¹³å°ã€‚
author: Mark Ku
---

## å¤šé€šè·¯èŠå¤©æ•´åˆçš„æŒ‘æˆ°

ç¾åœ¨å®¢æˆ¶éƒ½å¸Œæœ›èƒ½å¤ é€éå„ç¨®ç®¡é“è·Ÿä¼æ¥­å³æ™‚æºé€šï¼Œä¸ç®¡æ˜¯ç¶²ç«™èŠå¤©ã€WhatsAppã€Facebook Messengerã€Telegram é‚„æ˜¯å‚³çµ±çš„é›»è©±å®¢æœï¼Œæ¯å€‹ç®¡é“éƒ½ä»£è¡¨ä¸åŒçš„å®¢æˆ¶æ¥è§¸é»ã€‚ä½†æ˜¯ç®¡ç†é€™éº¼å¤šç¨ç«‹çš„é€šè¨Šç³»çµ±å¸¸å¸¸æœƒé‡åˆ°é€™äº›å•é¡Œï¼š

- **å®¢æˆ¶é«”é©—ä¸ä¸€è‡´**ï¼šä¸åŒç®¡é“çš„å›æ‡‰æ™‚é–“å’Œæœå‹™å“è³ªå·®å¾ˆå¤š
- **å®¢æœæ•ˆç‡ä½**ï¼šéœ€è¦åœ¨å¤šå€‹å¹³å°é–“åˆ‡æ›ï¼Œå·¥ä½œè®Šå¾—å¾ˆè¤‡é›œ
- **è³‡æ–™åˆ†æ•£**ï¼šå®¢æˆ¶å°è©±è¨˜éŒ„åˆ†æ•£åœ¨å„å€‹ç³»çµ±ä¸­
- **æˆæœ¬é«˜**ï¼šç¶­è­·å¤šå€‹ç³»çµ±çš„æŠ€è¡“å’ŒäººåŠ›æˆæœ¬å¾ˆé«˜

## ç‚ºä»€éº¼é¸æ“‡ Rocket.Chat Omnichannelï¼Ÿ

Rocket.Chat çš„ **Omnichannel** åŠŸèƒ½å°±æ˜¯ç‚ºäº†è§£æ±ºé€™äº›å•é¡Œè€Œè¨­è¨ˆçš„ã€‚å®ƒæä¾›äº†ä¸€å€‹çµ±ä¸€çš„å¹³å°ï¼Œè®“ä¼æ¥­å¯ä»¥ï¼š

### æ ¸å¿ƒå„ªå‹¢

1. **çµ±ä¸€ç®¡ç†ä»‹é¢**ï¼šæ‰€æœ‰é€šè¨Šç®¡é“åœ¨å–®ä¸€å¹³å°ä¸­ç®¡ç†
2. **æ™ºèƒ½è·¯ç”±**ï¼šæ ¹æ“šå®¢æœå°ˆé•·å’Œè² è¼‰è‡ªå‹•åˆ†é…å°è©±
3. **å®Œæ•´å°è©±æ­·å²**ï¼šè·¨ç®¡é“çš„å®¢æˆ¶äº’å‹•è¨˜éŒ„
4. **å³æ™‚åˆ†æ**ï¼šå¤šç¶­åº¦çš„å®¢æœç¸¾æ•ˆåˆ†æ
5. **é–‹æºè‡ªç”±**ï¼šå®Œå…¨æŒæ§è³‡æ–™å’Œå®¢è£½åŒ–éœ€æ±‚
6. **ç¤¾ç¾¤æ”¯æ´**ï¼šæ´»èºçš„é–‹æºç¤¾ç¾¤æä¾›æŠ€è¡“æ”¯æ´å’ŒæŒçºŒå‰µæ–°
7. **æˆæœ¬æ•ˆç›Š**ï¼šç„¡éœ€æ”¯ä»˜æ˜‚è²´çš„æˆæ¬Šè²»ç”¨ï¼Œé™ä½ç¸½æ“æœ‰æˆæœ¬

### æ”¯æ´çš„é€šè¨Šç®¡é“

- **ç¶²ç«™ Livechat**ï¼šåµŒå…¥å¼èŠå¤©è¦–çª—
- **WhatsApp Business API**ï¼šå®˜æ–¹ WhatsApp æ•´åˆ
- **Facebook Messenger**ï¼šFacebook ç²‰çµ²å°ˆé è¨Šæ¯
- **Telegram Bot**ï¼šTelegram æ©Ÿå™¨äººæ•´åˆ
- **é›»å­éƒµä»¶**ï¼šå‚³çµ±éƒµä»¶è½‰æ›ç‚ºèŠå¤©å½¢å¼
- **SMS**ï¼šç°¡è¨Šæœå‹™æ•´åˆ
- **è‡ªè¨‚ API**ï¼šé€é REST API æ•´åˆå…¶ä»–ç³»çµ±

### å…è²»ç‰ˆåŠŸèƒ½èªªæ˜

Rocket.Chat æä¾› **Starter æ–¹æ¡ˆå…è²»ç‰ˆ**ï¼ŒåŒ…å«æ™ºèƒ½è·¯ç”±ç­‰é€²éšåŠŸèƒ½ï¼š

#### âœ… å…è²»ç‰ˆå¯ç”¨åŠŸèƒ½
- **æ™ºèƒ½è·¯ç”±**ï¼šè‡ªå‹•å°‡ä¾†é›»è½‰ç™¼åˆ°é©ç•¶ä»£ç†äººæˆ–éƒ¨é–€
- **å¤šéšŠåˆ—è™•ç†**ï¼šæ”¯æ´å¤šå€‹å®¢æœåœ˜éšŠ
- **è®€å–å›åŸ·**ï¼šé¡¯ç¤ºè¨Šæ¯å·²è®€ç‹€æ…‹
- **ç„¡é™æ¨æ’­é€šçŸ¥**ï¼šç„¡é™åˆ¶çš„æ¨æ’­åŠŸèƒ½

#### ğŸš« ä½¿ç”¨é™åˆ¶
- **æœ€å¤§ 50 å€‹ä½¿ç”¨è€…**ï¼šæœ€å¤š 50 å€‹å¸³æˆ¶èƒ½ç™»å…¥
- **æ¯æœˆæœ€å¤š 100 å€‹æ´»èºè¯çµ¡äºº**ï¼šæœ€å¤šè™•ç† 100 å€‹ä¸åŒä¾†å®¢äº’å‹•è€…

#### ğŸ“Š ç‰ˆæœ¬æ¯”è¼ƒ

| åŠŸèƒ½ | Starterï¼ˆå…è²»ï¼‰ | Communityï¼ˆé–‹æºï¼‰ |
|------|----------------|------------------|
| æ™ºèƒ½è·¯ç”± | âœ… | âŒ |
| å¤šéšŠåˆ—è™•ç† | âœ… | âŒ |
| è®€å–å›åŸ· | âœ… | âŒ |
| æ¨æ’­é€šçŸ¥ | ç„¡é™ | é™ 10,000/æœˆ |
| ä½¿ç”¨è€…é™åˆ¶ | 50 ç”¨æˆ¶ | ç„¡é™åˆ¶ |
| æ´»èºè¯çµ¡äºº | 100/æœˆ | ç„¡æ”¯æ´ |

#### ğŸ’¡ é©ç”¨å ´æ™¯
- å°å‹åœ˜éšŠï¼ˆ50 äººä»¥ä¸‹ï¼‰
- å…¬çœ¾å®¢æœéœ€æ±‚
- åŸå‹é–‹ç™¼éšæ®µ
- å€‹äººæˆ–éç‡Ÿåˆ©çµ„ç¹”


## Docker éƒ¨ç½²æ¶æ§‹

ç‚ºäº†ç¢ºä¿ç³»çµ±çš„ç©©å®šæ€§å’Œå¯æ“´å±•æ€§ï¼Œæˆ‘å€‘æ¡ç”¨å¾®æœå‹™æ¶æ§‹éƒ¨ç½² Rocket.Chatï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Rocket.Chat    â”‚    â”‚  Rocket.Chat    â”‚    â”‚    MongoDB      â”‚
â”‚   (App Server)  â”‚â—„â”€â”€â–ºâ”‚   (App Server)  â”‚â—„â”€â”€â–ºâ”‚   (Database)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Livechat      â”‚    â”‚  Omnichannel    â”‚    â”‚   Analytics     â”‚
â”‚   Widget        â”‚    â”‚   Dashboard     â”‚    â”‚   & Reports     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è³‡æ–™åº«é…ç½®

æˆ‘å€‘ä½¿ç”¨ MongoDB ä½œç‚ºä¸»è¦è³‡æ–™åº«ï¼Œæä¾›ä»¥ä¸‹å„ªå‹¢ï¼š

- **æ–‡ä»¶å°å‘**ï¼šé©åˆå„²å­˜è¤‡é›œçš„èŠå¤©è¨˜éŒ„å’Œç”¨æˆ¶è³‡æ–™
- **æ°´å¹³æ“´å±•**ï¼šæ”¯æ´åˆ†ç‰‡å’Œè¤‡è£½é›†
- **é«˜å¯ç”¨æ€§**ï¼šè‡ªå‹•æ•…éšœè½‰ç§»å’Œè³‡æ–™å‚™ä»½
- **éˆæ´»æŸ¥è©¢**ï¼šæ”¯æ´è¤‡é›œçš„èšåˆæŸ¥è©¢å’Œå…¨æ–‡æœå°‹

## Docker Compose è¨­å®š

ä»¥ä¸‹æ˜¯å®Œæ•´çš„ `docker-compose.yaml` è¨­å®šæª”ï¼š

```yaml
version: '3.8'

services:
  rocketchat:
    image: registry.rocket.chat/rocketchat/rocket.chat:latest
    restart: always
    volumes:
      - ./uploads:/app/uploads
      - ./custom:/app/custom
    environment:
      - PORT=3000
      - ROOT_URL=https://chat.226network.com
      - MONGO_URL=mongodb://mongodb:27017/rocketchat
      - DEPLOY_METHOD=docker
      - DEPLOY_PLATFORM=linux/amd64
      # Omnichannel ç›¸é—œè¨­å®š
      - ENABLE_OMNICHANNEL=true
      - ENABLE_LIVECHAT=true
      - ENABLE_LIVECHAT_ANALYTICS=true
      # æ•ˆèƒ½å„ªåŒ–
      - CACHE_SIZE=100
      - CACHE_TTL=600
    ports:
      - 30047:3000
    deploy:
      resources:
        limits:
          memory: 2G
          cpus: '1.0'
        reservations:
          memory: 1G
          cpus: '0.5'

  # MongoDB è³‡æ–™åº«
  mongodb:
    image: mongo:6.0
    restart: always
    volumes:
      - mongodb_data:/data/db
    environment:
      - MONGO_INITDB_ROOT_USERNAME=admin
      - MONGO_INITDB_ROOT_PASSWORD=password123
      - MONGO_INITDB_DATABASE=rocketchat
    ports:
      - "27017:27017"
    command: mongod --auth

  # å¯é¸ï¼šRedis å¿«å–
  redis:
    image: redis:6-alpine
    restart: always
    volumes:
      - redis_data:/data
    command: redis-server --appendonly yes

volumes:
  mongodb_data:
  redis_data:
```

## éƒ¨ç½²æ­¥é©Ÿ

### 1. æº–å‚™ç’°å¢ƒ

```bash
# å»ºç«‹å°ˆæ¡ˆç›®éŒ„
mkdir rocket-chat
cd rocket-chat

# å»ºç«‹å¿…è¦çš„ç›®éŒ„
mkdir uploads
mkdir custom
mkdir mongodb-data
```

### 2. å•Ÿå‹•æœå‹™

```bash
# å•Ÿå‹•æ‰€æœ‰æœå‹™ï¼ˆåŒ…æ‹¬ MongoDBï¼‰
docker-compose up -d

# æŸ¥çœ‹æœå‹™ç‹€æ…‹
docker-compose ps

# æŸ¥çœ‹ Rocket.Chat æ—¥èªŒ
docker-compose logs -f rocketchat

# æŸ¥çœ‹ MongoDB æ—¥èªŒ
docker-compose logs -f mongodb
```

### 3. åˆå§‹è¨­å®š

1. è¨ªå• `http://localhost:30047`
2. å»ºç«‹ç®¡ç†å“¡å¸³è™Ÿ
3. è¨­å®šçµ„ç¹”è³‡è¨Š
4. ç¢ºèª MongoDB é€£ç·šç‹€æ…‹

### 4. MongoDB ç®¡ç†

```bash
# é€£ç·šåˆ° MongoDB å®¹å™¨
docker-compose exec mongodb mongosh -u admin -p password123

# æŸ¥çœ‹è³‡æ–™åº«
show dbs

# åˆ‡æ›åˆ° Rocket.Chat è³‡æ–™åº«
use rocketchat

# æŸ¥çœ‹é›†åˆ
show collections

# æŸ¥çœ‹ç”¨æˆ¶è³‡æ–™
db.users.find().limit(5)
```

## Omnichannel åŠŸèƒ½é…ç½®

### 1. å•Ÿç”¨ Omnichannel åŠŸèƒ½

1. é€²å…¥ç®¡ç†å¾Œå° â†’ **Omnichannel**
2. å•Ÿç”¨ **Livechat** åŠŸèƒ½
3. è¨­å®š **å·¥ä½œæµç¨‹** å’Œ **è‡ªå‹•å›è¦†**
4. é…ç½® **å®¢æœåœ˜éšŠ** å’Œ **å°ˆé•·é ˜åŸŸ**

### 2. ç¶²ç«™ Livechat æ•´åˆ

#### åŸºæœ¬åµŒå…¥ç¨‹å¼ç¢¼

```html
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤šé€šè·¯å®¢æœç³»çµ±</title>
    <style>
        /* è‡ªè¨‚èŠå¤©è¦–çª—æ¨£å¼ */
        .rocketchat-widget {
            bottom: 20px !important;
            right: 20px !important;
            max-width: 400px !important;
        }
        
        .livechat-room {
            border-radius: 12px !important;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12) !important;
        }
        
        .rocketchat-launcher {
            background: linear-gradient(135deg, #2962FF, #3F51B5) !important;
            border-radius: 50% !important;
            box-shadow: 0 4px 12px rgba(41, 98, 255, 0.3) !important;
        }
    </style>
</head>
<body>
    <!-- Rocket.Chat Livechat Script -->
    <script type="text/javascript">
    (function(w, d, s, u) {
        w.RocketChat = function(c) { w.RocketChat._.push(c) }; 
        w.RocketChat._ = []; 
        w.RocketChat.url = u;
        var h = d.getElementsByTagName(s)[0], j = d.createElement(s);
        j.async = true; 
        j.src = 'https://chat.226network.com/livechat/rocketchat-livechat.min.js?_=201903270000';
        h.parentNode.insertBefore(j, h);
    })(window, document, 'script', 'https://chat.226network.com/livechat');
    </script>
</body>
</html>
```

#### é€²éšè‡ªè¨‚åŠŸèƒ½

```javascript
// è‡ªè¨‚èŠå¤©è¦–çª—è¡Œç‚º
RocketChat(function() {
    this.on('chat-started', function() {
        console.log('èŠå¤©å·²é–‹å§‹');
        // å¯ä»¥è§¸ç™¼å…¶ä»–äº‹ä»¶ï¼Œå¦‚ Google Analytics
        gtag('event', 'livechat_started');
    });
    
    this.on('chat-ended', function() {
        console.log('èŠå¤©å·²çµæŸ');
        // æ”¶é›†å®¢æˆ¶æ»¿æ„åº¦èª¿æŸ¥
        this.showSurvey();
    });
});

// å‹•æ…‹è¼‰å…¥èŠå¤©è¦–çª—
function loadLivechat() {
    // å»¶é²è¼‰å…¥ï¼Œæå‡é é¢è¼‰å…¥é€Ÿåº¦
    setTimeout(() => {
        // è¼‰å…¥èŠå¤©è…³æœ¬
    }, 3000);
}
```


## Webhook æ•´åˆï¼šè¼•é¬†é€£æ¥å„ç¨®ç¤¾ç¾¤èŠå¤©å·¥å…·

Rocket.Chat çš„å¼·å¤§ä¹‹è™•åœ¨æ–¼å®ƒæä¾›äº†å®Œæ•´çš„ Webhook APIï¼Œè®“ä½ å¯ä»¥å¾ˆè¼•æ˜“åœ°å°‡å„ç¨®å¸¸è¦‹çš„ç¤¾ç¾¤èŠå¤©å·¥å…·æ•´åˆåˆ°çµ±ä¸€çš„ Omnichannel å¹³å°ä¸­ã€‚é€é Webhookï¼Œä½ å¯ä»¥ï¼š

### Webhook æ•´åˆçš„å„ªå‹¢

1. **çµ±ä¸€ç®¡ç†**ï¼šæ‰€æœ‰é€šè¨Šç®¡é“éƒ½åœ¨åŒä¸€å€‹å¹³å°ä¸­ç®¡ç†
2. **å³æ™‚åŒæ­¥**ï¼šè¨Šæ¯å¯ä»¥å³æ™‚é›™å‘åŒæ­¥
3. **å®¢è£½åŒ–å½ˆæ€§**ï¼šå¯ä»¥æ ¹æ“šéœ€æ±‚è‡ªè¨‚æ•´åˆé‚è¼¯
4. **æˆæœ¬æ•ˆç›Š**ï¼šä¸éœ€è¦è³¼è²·æ˜‚è²´çš„ç¬¬ä¸‰æ–¹æ•´åˆæœå‹™

### æ”¯æ´çš„æ•´åˆæ–¹å¼

- **Incoming Webhooks**ï¼šæ¥æ”¶å¤–éƒ¨ç³»çµ±çš„è¨Šæ¯
- **Outgoing Webhooks**ï¼šç™¼é€è¨Šæ¯åˆ°å¤–éƒ¨ç³»çµ±
- **REST API**ï¼šå®Œæ•´çš„ API ä»‹é¢
- **Real-time API**ï¼šå³æ™‚äº‹ä»¶è™•ç†

### å¸¸è¦‹æ•´åˆå ´æ™¯

1. **ç¤¾ç¾¤åª’é«”**ï¼šWhatsAppã€Facebook Messengerã€Telegram
2. **ä¼æ¥­å·¥å…·**ï¼šSlackã€Microsoft Teamsã€Discord
3. **å®¢æœç³»çµ±**ï¼šZendeskã€Freshdeskã€Intercom
4. **è‡ªè¨‚æ‡‰ç”¨**ï¼šå…¬å¸å…§éƒ¨ç³»çµ±ã€CRM ç³»çµ±

### Webhook è¨­å®šç¯„ä¾‹

#### å»ºç«‹ Incoming Webhook

```javascript
// å»ºç«‹ Incoming Webhook ä¾†æ¥æ”¶å¤–éƒ¨è¨Šæ¯
const createIncomingWebhook = async (channel, alias, avatar) => {
    const response = await fetch('/api/v1/webhooks.create', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-Auth-Token': AUTH_TOKEN,
            'X-User-Id': USER_ID
        },
        body: JSON.stringify({
            channel: channel,
            alias: alias,
            avatar: avatar
        })
    });
    
    return response.json();
};

// ä½¿ç”¨ç¯„ä¾‹
const webhook = await createIncomingWebhook('#general', 'å®¢æœæ©Ÿå™¨äºº', 'https://example.com/bot.png');
console.log('Webhook URL:', webhook.data.webhook.url);
```

#### å»ºç«‹ Outgoing Webhook

```javascript
// å»ºç«‹ Outgoing Webhook ä¾†ç™¼é€è¨Šæ¯åˆ°å¤–éƒ¨ç³»çµ±
const createOutgoingWebhook = async (channel, triggerWords, urls) => {
    const response = await fetch('/api/v1/webhooks.create', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-Auth-Token': AUTH_TOKEN,
            'X-User-Id': USER_ID
        },
        body: JSON.stringify({
            channel: channel,
            triggerWords: triggerWords,
            urls: urls,
            enabled: true
        })
    });
    
    return response.json();
};

// ä½¿ç”¨ç¯„ä¾‹
const outgoingWebhook = await createOutgoingWebhook(
    '#support', 
    ['help', 'support'], 
    ['https://your-api.com/webhook']
);
```

#### è™•ç† Webhook äº‹ä»¶

```javascript
// è™•ç†ä¾†è‡ªå¤–éƒ¨ç³»çµ±çš„ Webhook äº‹ä»¶
const handleWebhookEvent = (req, res) => {
    const { text, channel, alias, avatar, attachments } = req.body;
    
    // é©—è­‰ Webhook ä¾†æº
    if (!validateWebhookSource(req)) {
        return res.status(401).json({ error: 'Unauthorized' });
    }
    
    // è½‰æ›ç‚º Omnichannel æ ¼å¼
    const omnichannelMessage = {
        channel: 'webhook',
        text: text,
        alias: alias,
        avatar: avatar,
        attachments: attachments,
        timestamp: new Date()
    };
    
    // ç™¼é€åˆ°æŒ‡å®šçš„ Omnichannel ç®¡é“
    sendToOmnichannel(channel, omnichannelMessage);
    
    res.status(200).json({ success: true });
};

// é©—è­‰ Webhook ä¾†æº
const validateWebhookSource = (req) => {
    const signature = req.headers['x-signature'];
    const payload = JSON.stringify(req.body);
    const expectedSignature = crypto
        .createHmac('sha256', WEBHOOK_SECRET)
        .update(payload)
        .digest('hex');
    
    return signature === expectedSignature;
};
```

### 3. WhatsApp Business API æ•´åˆ

#### è¨­å®š WhatsApp Business API

```javascript
// WhatsApp æ•´åˆç¯„ä¾‹
const WhatsAppIntegration = {
    // è¨­å®š Webhook
    setupWebhook: function(webhookUrl) {
        return {
            url: webhookUrl,
            verify_token: 'your_verify_token',
            mode: 'subscribe'
        };
    },
    
    // è™•ç†æ¥æ”¶è¨Šæ¯
    handleIncomingMessage: function(message) {
        const { from, text, timestamp } = message;
        
        // è½‰ç™¼åˆ° Rocket.Chat Omnichannel
        this.forwardToOmnichannel({
            channel: 'whatsapp',
            customer: from,
            message: text,
            timestamp: timestamp
        });
    },
    
    // ç™¼é€è¨Šæ¯
    sendMessage: function(to, message) {
        // é€é WhatsApp Business API ç™¼é€
        return fetch('https://graph.facebook.com/v17.0/YOUR_PHONE_NUMBER_ID/messages', {
            method: 'POST',
            headers: {
                'Authorization': `Bearer ${YOUR_ACCESS_TOKEN}`,
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                messaging_product: 'whatsapp',
                to: to,
                type: 'text',
                text: { body: message }
            })
        });
    }
};
```

### 4. Facebook Messenger æ•´åˆ

#### Messenger å¹³å°è¨­å®š

```javascript
// Facebook Messenger æ•´åˆ
const MessengerIntegration = {
    // é©—è­‰ Webhook
    verifyWebhook: function(mode, token, challenge) {
        if (mode === 'subscribe' && token === 'YOUR_VERIFY_TOKEN') {
            return challenge;
        }
        return false;
    },
    
    // è™•ç† Messenger è¨Šæ¯
    handleMessage: function(senderId, message) {
        // è½‰æ›ç‚º Omnichannel æ ¼å¼
        const omnichannelMessage = {
            channel: 'facebook',
            customer: senderId,
            message: message.text,
            timestamp: Date.now()
        };
        
        // ç™¼é€åˆ° Rocket.Chat
        this.sendToRocketChat(omnichannelMessage);
    },
    
    // å›è¦†è¨Šæ¯
    sendReply: function(recipientId, message) {
        return fetch(`https://graph.facebook.com/v17.0/me/messages?access_token=${PAGE_ACCESS_TOKEN}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                recipient: { id: recipientId },
                message: { text: message }
            })
        });
    }
};
```

### 5. Telegram Bot æ•´åˆ

#### Telegram Bot è¨­å®š

```javascript
// Telegram Bot æ•´åˆ
const TelegramIntegration = {
    // è™•ç† Telegram æ›´æ–°
    handleUpdate: function(update) {
        if (update.message) {
            const { chat, text, from } = update.message;
            
            // è½‰æ›ç‚º Omnichannel æ ¼å¼
            const omnichannelMessage = {
                channel: 'telegram',
                customer: from.id,
                customerName: `${from.first_name} ${from.last_name || ''}`,
                message: text,
                chatId: chat.id,
                timestamp: update.message.date * 1000
            };
            
            // ç™¼é€åˆ° Rocket.Chat
            this.sendToOmnichannel(omnichannelMessage);
        }
    },
    
    // ç™¼é€è¨Šæ¯åˆ° Telegram
    sendMessage: function(chatId, message) {
        return fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                chat_id: chatId,
                text: message,
                parse_mode: 'HTML'
            })
        });
    }
};
```

## æ™ºèƒ½è·¯ç”±èˆ‡å·¥ä½œæµç¨‹

### 1. è‡ªå‹•è·¯ç”±è¨­å®š

```javascript
// æ™ºèƒ½è·¯ç”±è¦å‰‡
const routingRules = {
    // æ ¹æ“šé—œéµå­—è·¯ç”±
    keywordRouting: {
        'æŠ€è¡“æ”¯æ´': 'tech-support',
        'å¸³å–®å•é¡Œ': 'billing',
        'ç”¢å“è«®è©¢': 'sales',
        'æŠ•è¨´': 'complaints'
    },
    
    // æ ¹æ“šå®¢æˆ¶ç­‰ç´šè·¯ç”±
    customerTierRouting: {
        'VIP': 'vip-support',
        'Premium': 'premium-support',
        'Standard': 'general-support'
    },
    
    // æ ¹æ“šèªè¨€è·¯ç”±
    languageRouting: {
        'zh-TW': 'taiwan-team',
        'en-US': 'english-team',
        'ja-JP': 'japanese-team'
    }
};

// è·¯ç”±é‚è¼¯
function routeConversation(message, customerInfo) {
    let department = 'general-support';
    
    // æª¢æŸ¥é—œéµå­—
    for (const [keyword, dept] of Object.entries(routingRules.keywordRouting)) {
        if (message.toLowerCase().includes(keyword)) {
            department = dept;
            break;
        }
    }
    
    // æª¢æŸ¥å®¢æˆ¶ç­‰ç´š
    if (customerInfo.tier && routingRules.customerTierRouting[customerInfo.tier]) {
        department = routingRules.customerTierRouting[customerInfo.tier];
    }
    
    return department;
}
```

### 2. è‡ªå‹•å›è¦†è¨­å®š

```javascript
// è‡ªå‹•å›è¦†è¦å‰‡
const autoReplyRules = {
    // æ­¡è¿è¨Šæ¯
    welcome: {
        trigger: 'chat_started',
        message: 'æ‚¨å¥½ï¼æ­¡è¿ä½¿ç”¨æˆ‘å€‘çš„å®¢æœç³»çµ±ã€‚æˆ‘å€‘æœƒç›¡å¿«ç‚ºæ‚¨æœå‹™ã€‚',
        delay: 0
    },
    
    // å¿™ç¢Œæ™‚è‡ªå‹•å›è¦†
    busy: {
        trigger: 'no_agent_available',
        message: 'ç›®å‰å®¢æœäººå“¡å¿™ç¢Œä¸­ï¼Œè«‹ç¨å€™ç‰‡åˆ»ã€‚æ‚¨çš„è¨Šæ¯æˆ‘å€‘æœƒç›¡å¿«å›è¦†ã€‚',
        delay: 5
    },
    
    // ä¸‹ç­æ™‚é–“å›è¦†
    afterHours: {
        trigger: 'outside_business_hours',
        message: 'ç›®å‰ç‚ºéç‡Ÿæ¥­æ™‚é–“ï¼Œæˆ‘å€‘æœƒåœ¨æ˜å¤©ç‡Ÿæ¥­æ™‚é–“å…§å›è¦†æ‚¨çš„è¨Šæ¯ã€‚',
        delay: 0
    }
};

// è‡ªå‹•å›è¦†è™•ç†
function handleAutoReply(trigger, customerInfo) {
    const rule = autoReplyRules[trigger];
    if (rule) {
        setTimeout(() => {
            sendMessage(customerInfo.channel, customerInfo.customerId, rule.message);
        }, rule.delay * 1000);
    }
}
```

## è³‡æ–™åˆ†æèˆ‡å ±è¡¨

### 1. å®¢æœç¸¾æ•ˆåˆ†æ

```javascript
// ç¸¾æ•ˆåˆ†æ API
const AnalyticsAPI = {
    // ç²å–å®¢æœç¸¾æ•ˆ
    getAgentPerformance: async function(agentId, dateRange) {
        const response = await fetch(`/api/analytics/agent/${agentId}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-Auth-Token': AUTH_TOKEN
            },
            body: JSON.stringify({
                startDate: dateRange.start,
                endDate: dateRange.end,
                metrics: ['response_time', 'satisfaction_score', 'conversations_handled']
            })
        });
        
        return response.json();
    },
    
    // ç®¡é“ä½¿ç”¨åˆ†æ
    getChannelAnalytics: async function(dateRange) {
        const response = await fetch('/api/analytics/channels', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-Auth-Token': AUTH_TOKEN
            },
            body: JSON.stringify({
                startDate: dateRange.start,
                endDate: dateRange.end
            })
        });
        
        return response.json();
    },
    
    // å®¢æˆ¶æ»¿æ„åº¦åˆ†æ
    getSatisfactionAnalytics: async function(dateRange) {
        const response = await fetch('/api/analytics/satisfaction', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-Auth-Token': AUTH_TOKEN
            },
            body: JSON.stringify({
                startDate: dateRange.start,
                endDate: dateRange.end
            })
        });
        
        return response.json();
    }
};
```

### 2. å³æ™‚ç›£æ§å„€è¡¨æ¿

```javascript
// å³æ™‚ç›£æ§
const RealTimeMonitoring = {
    // é€£æ¥ WebSocket ç²å–å³æ™‚è³‡æ–™
    connectWebSocket: function() {
        const ws = new WebSocket('wss://chat.226network.com/websocket');
        
        ws.onmessage = function(event) {
            const data = JSON.parse(event.data);
            
            switch(data.type) {
                case 'omnichannel_status':
                    this.updateAgentStatus(data);
                    break;
                case 'new_conversation':
                    this.handleNewConversation(data);
                    break;
                case 'conversation_ended':
                    this.handleConversationEnded(data);
                    break;
            }
        };
    },
    
    // æ›´æ–°å®¢æœç‹€æ…‹
    updateAgentStatus: function(data) {
        const { agentId, status, currentConversations } = data;
        
        // æ›´æ–° UI é¡¯ç¤º
        document.getElementById(`agent-${agentId}-status`).textContent = status;
        document.getElementById(`agent-${agentId}-conversations`).textContent = currentConversations;
    },
    
    // è™•ç†æ–°å°è©±
    handleNewConversation: function(data) {
        const { conversationId, channel, customer, message } = data;
        
        // æ–°å¢åˆ°å°è©±åˆ—è¡¨
        this.addConversationToList({
            id: conversationId,
            channel: channel,
            customer: customer,
            message: message,
            timestamp: new Date()
        });
        
        // æ’­æ”¾é€šçŸ¥éŸ³æ•ˆ
        this.playNotificationSound();
    }
};
```

## é€²éšåŠŸèƒ½èˆ‡æ•´åˆ

### 1. CRM ç³»çµ±æ•´åˆ

```javascript
// CRM æ•´åˆç¯„ä¾‹
const CRMIntegration = {
    // åŒæ­¥å®¢æˆ¶è³‡æ–™
    syncCustomerData: async function(customerId) {
        const customerData = await this.getCustomerFromCRM(customerId);
        
        // æ›´æ–° Rocket.Chat å®¢æˆ¶è³‡æ–™
        await this.updateRocketChatCustomer(customerId, {
            name: customerData.name,
            email: customerData.email,
            phone: customerData.phone,
            tier: customerData.tier,
            tags: customerData.tags
        });
    },
    
    // è¨˜éŒ„å°è©±åˆ° CRM
    logConversationToCRM: async function(conversationId, customerId, messages) {
        await this.createCRMActivity({
            type: 'chat_conversation',
            customerId: customerId,
            conversationId: conversationId,
            messages: messages,
            timestamp: new Date()
        });
    },
    
    // ç²å–å®¢æˆ¶æ­·å²è¨˜éŒ„
    getCustomerHistory: async function(customerId) {
        const history = await this.getCRMHistory(customerId);
        
        return history.map(record => ({
            type: record.type,
            description: record.description,
            date: record.date,
            agent: record.agent
        }));
    }
};
```

### 2. AI æ™ºèƒ½åŠ©æ‰‹æ•´åˆ

```javascript
// AI åŠ©æ‰‹æ•´åˆ
const AIAssistant = {
    // æ™ºèƒ½å›è¦†å»ºè­°
    getSmartReplies: async function(message, context) {
        const response = await fetch('/api/ai/smart-replies', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                message: message,
                context: context,
                language: 'zh-TW'
            })
        });
        
        return response.json();
    },
    
    // æƒ…æ„Ÿåˆ†æ
    analyzeSentiment: async function(message) {
        const response = await fetch('/api/ai/sentiment', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                text: message
            })
        });
        
        return response.json();
    },
    
    // è‡ªå‹•åˆ†é¡
    autoCategorize: async function(message) {
        const response = await fetch('/api/ai/categorize', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                message: message
            })
        });
        
        return response.json();
    }
};
```

### è‡ªè¨‚é–‹ç™¼èˆ‡æ“´å±•

#### 1. å»ºç«‹è‡ªè¨‚ä¸»é¡Œ

```javascript
// è‡ªè¨‚ä¸»é¡Œç¯„ä¾‹
const CustomTheme = {
    name: 'custom-theme',
    version: '1.0.0',
    
    // è‡ªè¨‚æ¨£å¼
    styles: {
        '--rc-color-primary': '#2962FF',
        '--rc-color-primary-lightest': '#E3F2FD',
        '--rc-color-primary-light': '#90CAF9',
        '--rc-color-primary-dark': '#1565C0',
        '--rc-color-primary-darkest': '#0D47A1'
    },
    
    // è‡ªè¨‚çµ„ä»¶
    components: {
        'livechat-widget': {
            template: './components/livechat-widget.html',
            styles: './components/livechat-widget.css'
        }
    }
};

// è¨»å†Šä¸»é¡Œ
RocketChat.registerTheme(CustomTheme);
```

#### 2. é–‹ç™¼è‡ªè¨‚ App

```javascript
// è‡ªè¨‚ App ç¯„ä¾‹
class CustomOmnichannelApp {
    constructor() {
        this.name = 'custom-omnichannel-app';
        this.version = '1.0.0';
        this.description = 'è‡ªè¨‚ Omnichannel åŠŸèƒ½æ“´å±•';
    }
    
    // åˆå§‹åŒ–
    async initialize() {
        // è¨»å†Šäº‹ä»¶ç›£è½å™¨
        this.registerEventListeners();
        
        // è¼‰å…¥è‡ªè¨‚åŠŸèƒ½
        await this.loadCustomFeatures();
    }
    
    // è¨»å†Šäº‹ä»¶ç›£è½å™¨
    registerEventListeners() {
        // ç›£è½æ–°å°è©±äº‹ä»¶
        RocketChat.on('omnichannel:conversation:started', (conversation) => {
            this.handleNewConversation(conversation);
        });
        
        // ç›£è½è¨Šæ¯äº‹ä»¶
        RocketChat.on('omnichannel:message:received', (message) => {
            this.processMessage(message);
        });
    }
    
    // è™•ç†æ–°å°è©±
    handleNewConversation(conversation) {
        // è‡ªè¨‚é‚è¼¯
        console.log('æ–°å°è©±é–‹å§‹:', conversation);
        
        // è‡ªå‹•åˆ†é¡
        this.autoCategorize(conversation);
        
        // æ™ºèƒ½è·¯ç”±
        this.smartRouting(conversation);
    }
    
    // è™•ç†è¨Šæ¯
    processMessage(message) {
        // æƒ…æ„Ÿåˆ†æ
        this.analyzeSentiment(message);
        
        // é—œéµå­—æª¢æ¸¬
        this.detectKeywords(message);
        
        // è‡ªå‹•å›è¦†
        this.autoReply(message);
    }
}

// è¨»å†Š App
RocketChat.registerApp(new CustomOmnichannelApp());
```

#### 3. API æ“´å±•

```javascript
// è‡ªè¨‚ API ç«¯é»
const CustomAPI = {
    // è¨»å†Šè‡ªè¨‚è·¯ç”±
    registerRoutes: function(app) {
        // è‡ªè¨‚åˆ†æ API
        app.get('/api/v1/custom/analytics', async (req, res) => {
            try {
                const analytics = await this.getCustomAnalytics(req.query);
                res.json(analytics);
            } catch (error) {
                res.status(500).json({ error: error.message });
            }
        });
        
        // è‡ªè¨‚æ•´åˆ API
        app.post('/api/v1/custom/integration', async (req, res) => {
            try {
                const result = await this.handleCustomIntegration(req.body);
                res.json(result);
            } catch (error) {
                res.status(500).json({ error: error.message });
            }
        });
    },
    
    // è‡ªè¨‚åˆ†æåŠŸèƒ½
    getCustomAnalytics: async function(params) {
        // å¯¦ä½œè‡ªè¨‚åˆ†æé‚è¼¯
        return {
            totalConversations: 1000,
            averageResponseTime: 120,
            satisfactionScore: 4.5,
            channelDistribution: {
                website: 40,
                whatsapp: 30,
                facebook: 20,
                telegram: 10
            }
        };
    },
    
    // è‡ªè¨‚æ•´åˆè™•ç†
    handleCustomIntegration: async function(data) {
        // å¯¦ä½œè‡ªè¨‚æ•´åˆé‚è¼¯
        return {
            success: true,
            message: 'æ•´åˆæˆåŠŸ',
            data: data
        };
    }
};
```

## ç¸½çµ

Rocket.Chat çš„ Omnichannel åŠŸèƒ½ç‚ºä¼æ¥­æä¾›äº†ä¸€å€‹å¼·å¤§çš„å¤šé€šè·¯å®¢æœè§£æ±ºæ–¹æ¡ˆï¼Œé€éçµ±ä¸€çš„å¹³å°ç®¡ç†å„ç¨®é€šè¨Šç®¡é“ï¼Œä¼æ¥­å¯ä»¥ï¼š

- **æå‡å®¢æˆ¶é«”é©—**ï¼šä¸€è‡´çš„æœå‹™å“è³ªå’Œå¿«é€Ÿçš„å›æ‡‰æ™‚é–“
- **æé«˜å®¢æœæ•ˆç‡**ï¼šçµ±ä¸€ä»‹é¢å’Œæ™ºèƒ½è·¯ç”±åŠŸèƒ½
- **é™ä½ç‡Ÿé‹æˆæœ¬**ï¼šæ¸›å°‘ç³»çµ±ç¶­è­·å’ŒäººåŠ›æˆæœ¬
- **ç²å¾—æ·±åº¦æ´å¯Ÿ**ï¼šå®Œæ•´çš„å®¢æˆ¶äº’å‹•æ•¸æ“šåˆ†æ
- **é–‹æºå„ªå‹¢**ï¼šå®Œå…¨æŒæ§ç¨‹å¼ç¢¼ï¼Œåƒèˆ‡æ´»èºçš„é–‹ç™¼è€…ç¤¾ç¾¤
- **è³‡æ–™åº«éˆæ´»æ€§**ï¼šMongoDB æä¾›å¼·å¤§çš„æ–‡ä»¶å„²å­˜å’ŒæŸ¥è©¢èƒ½åŠ›

### å…è²»ç‰ˆ vs ä»˜è²»ç‰ˆé¸æ“‡

**Starter å…è²»ç‰ˆé©åˆ**ï¼š
- å°å‹åœ˜éšŠï¼ˆ50 äººä»¥ä¸‹ï¼‰
- éœ€è¦æ™ºèƒ½è·¯ç”±åŠŸèƒ½
- æ¯æœˆæ´»èºè¯çµ¡äºº 100 å€‹ä»¥ä¸‹
- é ç®—æœ‰é™ä½†éœ€è¦é€²éšåŠŸèƒ½

**ä»˜è²»ç‰ˆé©åˆ**ï¼š
- å¤§å‹ä¼æ¥­æˆ–çµ„ç¹”
- éœ€è¦å®Œæ•´ Omnichannel åŠŸèƒ½
- è¶…éå…è²»ç‰ˆä½¿ç”¨é™åˆ¶
- ä¼æ¥­ç´šæŠ€è¡“æ”¯æ´éœ€æ±‚

**Community é–‹æºç‰ˆé©åˆ**ï¼š
- æœ‰æŠ€è¡“èƒ½åŠ›å¯ä»¥è‡ªæ¶è¨­
- åªéœ€è¦åŸºæœ¬èŠå¤©åŠŸèƒ½
- é¡˜æ„æŠ•å…¥æŠ€è¡“ç¶­è­·
- ç„¡ä½¿ç”¨è€…æ•¸é‡é™åˆ¶


## ç›¸é—œè³‡æº
- [Rocket.Chat å®˜æ–¹æ–‡ä»¶](https://docs.rocket.chat/)
- [Omnichannel åŠŸèƒ½æŒ‡å—](https://docs.rocket.chat/guides/omnichannel/)
- [API åƒè€ƒæ–‡ä»¶](https://developer.rocket.chat/)
- [ç¤¾ç¾¤è«–å£‡](https://forums.rocket.chat/)
- [GitHub å°ˆæ¡ˆ](https://github.com/RocketChat/Rocket.Chat)
- [è²¢ç»æŒ‡å—](https://github.com/RocketChat/Rocket.Chat/blob/develop/CONTRIBUTING.md)
- [é–‹ç™¼è€…æ–‡ä»¶](https://developer.rocket.chat/)
- [Discord ç¤¾ç¾¤](https://discord.gg/rocketchat)
- [Stack Overflow æ¨™ç±¤](https://stackoverflow.com/questions/tagged/rocket.chat)
- [é–‹æºæˆæ¬Š (MIT)](https://github.com/RocketChat/Rocket.Chat/blob/develop/LICENSE)

